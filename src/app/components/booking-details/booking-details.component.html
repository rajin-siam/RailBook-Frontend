<div class="container">
  <div *ngIf="loading" class="loading">Loading booking details...</div>
  
  <div *ngIf="error" class="error-box">
    <p>{{ error }}</p>
    <button class="btn btn-primary" (click)="goBack()">Back to Booking</button>
  </div>

  <div *ngIf="booking && !loading" class="invoice-card">
    <div class="invoice-header">
      <h1>ðŸŽ« Booking Confirmation</h1>
      <div class="status-badge" [class.confirmed]="booking.status === 'Confirmed'">
        {{ booking.status }}
      </div>
    </div>

    <div class="booking-info">
      <div class="info-row">
        <span class="label">Booking ID:</span>
        <span class="value">#{{ booking.id }}</span>
      </div>
      <div class="info-row">
        <span class="label">Booking Date:</span>
        <span class="value">{{ booking.bookingDate | date:'medium' }}</span>
      </div>
      <div class="info-row">
        <span class="label">Route:</span>
        <span class="value">{{ booking.source }} â†’ {{ booking.destination }}</span>
      </div>
      <div class="info-row">
        <span class="label">Base Fare:</span>
        <span class="value">{{ booking.perTicketPrice }} BDT per ticket</span>
      </div>
    </div>

    <div class="passengers-section">
      <h2>Passenger Details</h2>
      
      <div *ngFor="let passenger of booking.passengers; let i = index" class="passenger-detail">
        <div class="passenger-info-header">
          <h3>{{ passenger.name }}</h3>
          <span class="passenger-meta">{{ passenger.age }} years â€¢ {{ passenger.gender }}</span>
        </div>

        <div class="services-list" *ngIf="passenger.trainServices.length > 0">
          <h4>Services:</h4>
          <div *ngFor="let service of passenger.trainServices" class="service-detail">
            <span>{{ service.serviceName }}</span>
            <span>{{ service.price }} BDT</span>
          </div>
        </div>

        <div class="passenger-total">
          <span>Passenger Total:</span>
          <span>{{ getPassengerTotal(passenger) }} BDT</span>
        </div>
      </div>
    </div>

    <div class="invoice-summary">
      <h2>Invoice Summary</h2>
      <div class="summary-row">
        <span>Invoice ID:</span>
        <span>#{{ booking.invoice?.id }}</span>
      </div>
      <div class="summary-row">
        <span>Created:</span>
        <span>{{ booking.invoice?.createdAt | date:'short' }}</span>
      </div>
      <div class="summary-row total">
        <span><strong>Total Amount:</strong></span>
        <span><strong>{{ booking.invoice?.totalAmount }} BDT</strong></span>
      </div>
    </div>

    <div class="action-buttons no-print">
      <button class="btn btn-secondary" (click)="goBack()">New Booking</button>
      <button class="btn btn-primary" (click)="printInvoice()">Print Invoice</button>
    </div>
  </div>
</div>
